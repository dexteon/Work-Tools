
function doGet(e) {
  return HtmlService.createHtmlOutputFromFile('Index');
}

function getContacts(searchQuery) {
  const ss = SpreadsheetApp.openByUrl('https://docs.google.com/spreadsheets/d/e/2PACX-1vTMqS9jfJnH7RLc8zeNJ56-9XgxfOHGarVQE_46u1SlMUJm2NGXGeF9vZO58uDVRp26ZH__p9zqM9UG/pubhtml');
  const sheet = ss.getSheetByName('Formatted Entries'); // Ensure this matches your sheet name
  let data = sheet.getDataRange().getValues();
  if (searchQuery) {
    data = data.filter(row => row.join().toLowerCase().includes(searchQuery.toLowerCase()));
  }
  return data;
}


<!DOCTYPE html>
<html>
  <head>
    <title>Searchable Contact List</title>
  </head>
  <body>
    Search: <input type="text" id="searchInput" onkeyup="searchContacts()" placeholder="Type to search...">
    <div id="tableContainer"></div>

    <script>
      function searchContacts() {
        const searchQuery = document.getElementById('searchInput').value;
        google.script.run.withSuccessHandler(function(data) {
          // Function to dynamically build the table with data
          buildTable(data);
        }).getContacts(searchQuery);
      }

      function buildTable(data) {
        let tableHTML = "<table border='1'>";
        // Assuming the first row is headers
        tableHTML += "<tr>";
        data[0].forEach(header => tableHTML += "<th>" + header + "</th>");
        tableHTML += "</tr>";
        // Data rowshttps://docs.google.com/spreadsheets/d/e/2PACX-1vTMqS9jfJnH7RLc8zeNJ56-9XgxfOHGarVQE_46u1SlMUJm2NGXGeF9vZO58uDVRp26ZH__p9zqM9UG/pub?output=csv
        for (let i = 1; i < data.length; i++) {
          tableHTML += "<tr>";
          data[i].forEach(cell => tableHTML += "<td>" + cell + "</td>");
          tableHTML += "</tr>";
        }
        tableHTML += "</table>";
        document.getElementById('tableContainer').innerHTML = tableHTML;
      }

      // Initial load
      document.addEventListener('DOMContentLoaded', function() {
        searchContacts(); // Load all contacts initially
      });
    </script>
  </body>
</html>

