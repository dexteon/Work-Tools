function processPhonebook() {
  var doc = DocumentApp.openById('1jM4fwIg3u8bptOk0CVgOo0d8fr2TI978LFsQQCM3epg');
  var text = doc.getBody().getText();
  var lines = text.split('\n');
  
  Logger.log('Document Loaded. # of lines is: ' + lines.length);

  var sheet = SpreadsheetApp.openById('1sQLj73TD24iHIQFUQNup6OqL5h7VRDwWg9mXG1o-57k');
  var formattedSheet = sheet.getSheetByName('Formatted Entries');
  var unformattedSheet = sheet.getSheetByName('Unformatted Entries');
  var statisticsSheet = sheet.getSheetByName('Statistics');
  var errorsSheet = sheet.getSheetByName('Errors') || sheet.insertSheet('Errors');
  
  clearAndSetHeaders(formattedSheet, ['Name', 'Company', 'Phone Number', 'Email', 'Notes']);
  clearAndSetHeaders(unformattedSheet, ['Unformatted Data']);
  clearAndSetHeaders(statisticsSheet, ['Statistic', 'Value']);
  clearAndSetHeaders(errorsSheet, ['Name', 'Company', 'Phone Number', 'Email', 'Notes']);

  var formattedData = [];
  var unformattedData = [];
  var errorsData = [];
  var companyCount = {};
  var entryPattern = /^(.+)\s+w\/(.+)\s+([0-9\-\+\(\) ]+)\s+(.+)$/;
  
  lines.slice(1).forEach(function(line) {
    var patternToUse = entryPattern.test(line) ? entryPattern : entryPattern;
    if (patternToUse.test(line)) {
      var matches = line.match(patternToUse);
      var name = matches[1].trim();
      var company = matches[2].trim();
      var phone = matches[3].trim();
      var email = matches[4].trim();

      var plusIndex = company.indexOf('+');
      if (plusIndex !== -1) {
        phone = company.substring(plusIndex) + " " + phone;
        company = company.substring(0, plusIndex).trim();
      }

      if (!name || !company || !phone || !email) {
        errorsData.push([name, company, phone, email, ""]); // Added empty string for notes
      } else {
        formattedData.push([name, company, phone, email, ""]); // Added empty string for notes
        if (companyCount[company]) {
          companyCount[company]++;
        } else {
          companyCount[company] = 1;
        }
      }
    } else {
      unformattedData.push([line]);
    }
  });

  populateSheetWithData(formattedSheet, formattedData, 2);
  populateSheetWithData(unformattedSheet, unformattedData, 2);
  populateSheetWithData(errorsSheet, errorsData, 2);

  addStatistics(statisticsSheet, lines, formattedData, unformattedData, companyCount);

  formattedSheet.getRange(2, 1, formattedSheet.getLastRow() - 1, formattedSheet.getLastColumn()).sort(1);

  Logger.log('Script Done.');
}
